<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <link href="https://fonts.googleapis.com/css?family=Lato:100,300,400,700,900" rel="stylesheet" />
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700;800&display=swap" rel="stylesheet" />

        <link rel="stylesheet" href="../stylesheets/style.css" />
        <link rel="shortcut icon" type="image/png" href="../img/favicon.png" />

        <title>cuha-on</title>
    </head>

    <body>
        <%- include('../common/header') -%>

        <main class="main">
            <div class="__hiddenSolver" style="width: 100%; height: 2rem"></div>
            <div class="section__area">
                <section class="section-searchbox global-bg__white">
                    <div class="section-searchbox__area">
                        <!-- float : left -->
                        <div class="section-searchbox__area-icon">
                            <svg
                                data-v-f0f8ee3e=""
                                aria-hidden="true"
                                focusable="false"
                                data-prefix="dh"
                                data-icon="search"
                                role="img"
                                xmlns="http://www.w3.org/2000/svg"
                                viewBox="0 0 24 24"
                                class="svg-inline--fa fa-search fa-w-16"
                            >
                                <path
                                    fill="currentColor"
                                    d="M19.9 20.5c-.2 0-.4-.1-.5-.2L15 15.9c-1.3 1.1-2.9 1.7-4.7 1.7-2 0-3.9-.8-5.2-2.2C3.7 14 3 12.2 3 10.3 3 6.3 6.3 3 10.3 3s7.3 3.3 7.3 7.3c0 1.7-.6 3.2-1.6 4.5l4.4 4.4c.3.3.3.8 0 1.1-.1.2-.3.2-.5.2zm-9.6-16c-3.2 0-5.8 2.6-5.8 5.8 0 1.5.6 2.9 1.6 4 1.1 1.1 2.6 1.8 4.2 1.8s3.1-.6 4.2-1.8c1.1-1.1 1.6-2.5 1.6-4 0-3.2-2.6-5.8-5.8-5.8z"
                                    class=""
                                ></path>
                            </svg>
                        </div>
                        <div class="section-searchbox__area-input">
                          <form action="/wargame" method="GET">
                            <input type="text" placeholder="찾고 싶은 문제를 검색하세요." name="title" />
                            </form>
                        </div>
                    </div>
                </section>
                <section class="section-lists">
                  <form action="/wargame" method="GET">
                    <!-- float : left -->
                    <div class="section-lists__filter global-bg__white">
                        <p class="section-lists__filter-title">문제분야</p>
                        <div class="section-lists__filter-checkbox">
                            <input type="checkbox" id="problems_all" name="problems" />
                            <label for="problems_all"
                                ><div class="section-lists__filter-checkbox__icon"></div>
                                <p>전체</p></label
                            >
                        </div>
                        <div class="section-lists__filter-checkbox">
                            <input type="checkbox" id="problems" name="problems_syshack" />
                            <label for="problems_syshack"
                                ><div class="section-lists__filter-checkbox__icon"></div>
                                <p>시스템해킹</p></label
                            >
                        </div>
                        <div class="section-lists__filter-checkbox">
                            <input type="checkbox" id="problems_reversing" name="problems" />
                            <label for="problems_reversing"
                                ><div class="section-lists__filter-checkbox__icon"></div>
                                <p>리버싱</p></label
                            >
                        </div>
                        <div class="section-lists__filter-checkbox">
                            <input type="checkbox" id="problems_webhack" name="problems" />
                            <label for="problems_webhack"
                                ><div class="section-lists__filter-checkbox__icon"></div>
                                <p>웹해킹</p></label
                            >
                        </div>
                        <div class="section-lists__filter-checkbox">
                            <input type="checkbox" id="problems_enc" name="problems" />
                            <label for="problems_enc"
                                ><div class="section-lists__filter-checkbox__icon"></div>
                                <p>암호화</p></label
                            >
                        </div>
                        <div class="section-lists__filter-checkbox">
                            <input type="checkbox" id="problems_foren" name="problems" />
                            <label for="problems_foren"
                                ><div class="section-lists__filter-checkbox__icon"></div>
                                <p>포렌식</p></label
                            >
                        </div>
                        <div class="section-lists__filter-checkbox">
                            <input type="checkbox" id="problems_etc" name="problems" />
                            <label for="problems_etc"
                                ><div class="section-lists__filter-checkbox__icon"></div>
                                <p>기타</p></label
                            >
                        </div>
                        <!-- ---------------------------------------------------- -->
                        <p class="section-lists__filter-title">난이도</p>
                        <div class="section-lists__filter-checkbox">
                            <input type="checkbox" id="level1" name="level" />
                            <label for="level1"
                                ><div class="section-lists__filter-checkbox__icon"></div>
                                <p>Level 1</p></label
                            >
                        </div>
                        <div class="section-lists__filter-checkbox">
                            <input type="checkbox" id="level2" name="level" />
                            <label for="level2"
                                ><div class="section-lists__filter-checkbox__icon"></div>
                                <p>Level 2</p></label
                            >
                        </div>
                        <div class="section-lists__filter-checkbox">
                            <input type="checkbox" id="level3" name="level" />
                            <label for="level3"
                                ><div class="section-lists__filter-checkbox__icon"></div>
                                <p>Level 3</p></label
                            >
                        </div>
                        <div class="section-lists__filter-checkbox">
                            <input type="checkbox" id="level4" name="level" />
                            <label for="level4"
                                ><div class="section-lists__filter-checkbox__icon"></div>
                                <p>Level 4</p></label
                            >
                        </div>
                        <div class="section-lists__filter-checkbox">
                            <input type="checkbox" id="level5" name="level" />
                            <label for="level5"
                                ><div class="section-lists__filter-checkbox__icon"></div>
                                <p>Level 5</p></label
                            >
                        </div>
                    </div>
                  </form>

                    <div class="section-lists__items global-bg__white" style="padding-bottom: 10rem">
                      <%if(emptySearch){%>
                      <p>게시글이 없습니다.</p>
                      <%}%>
                        <!-- responsive -->
                        <% posts.forEach(function(post){ %>
                        <!-- item -->
                        <a href="/wargame/<%= post._id%>" class="section-lists__items-item">
                            <div class="section-lists__items-item__border-1"></div>
                            <div class="section-lists__items-item__title"><%= post.title %></div>
                            <div class="section-lists__items-item__sub">
                                <div class="section-lists__items-item__sub-where">
                                    <%= post.type%>&nbsp;<%= post.level%><br><%= post.createdAt %></div>
                                <div class="section-lists__items-item__sub-howmany"><%= post.solved %></div>
                            </div>
                        </a>
                        <% }) %>
                    </div>
                        
                </section>

                <!-- 페이징이 추가된 부분 -->
                <div class="section-paging">
                    <div class="section-comment__paging" style="margin-top: 0">
                        <!-- float : left  -->
                        <%
                  let prevEnabled = paging.currentPage > 1;
                  let nextEnabled = paging.currentPage < paging.totalPage;
                %>
                <%if(prevEnabled){%><button class="section-comment__paging-button" type="button"><a href="/wargame?page=<%= paging.currentPage-1 %>&limit=<%=paging.limit%>&title=<%=titleCount%>">&lt;</a></button><%}%>
                <% for(let i=1; i<= paging.totalPage; i++){%>
                  <%if(i==1 || i==paging.totalPage || (i>=paging.currentPage-2 && i<=paging.currentPage+2)){%>
                  <button class="section-comment__paging-button<%if(i==paging.currentPage){%>__activated<%}%>" type="button"><a href="/wargame?page=<%= i %>&limit=<%=paging.limit%>&title=<%=titleCount%>"><%= i %></a></button>
                  <%} else if(i==2||i==paging.totalPage-1){%>
                    <button class="section-comment__paging-button" type="button">...</button>
                  <%}%>
                <%}%>
                <%if(nextEnabled){%><button class="section-comment__paging-button" type="button"><a href="/wargame?page=<%= paging.currentPage+1%>&limit=<%=paging.limit%>&title=<%=titleCount%>">&gt;</a></button><%}%>
                    </div>
                </div>
                <!-- 페이징이 추가된 부분 -->

                <!-- 관리자 도구 -->
                <!-- 백엔드에서 관리자가 보는게 아니면 이하 style="display"에 none삽입 -->
                <%if(user && user.roleType === 'admin'){%>
                <section class="section-admintool" style="display: ''">
                    <div class="section-admintool__area">
                        <p>관리자 도구</p>
                        <a href="/wargame/create" class="global-button__default">새 문제 만들기</a>
                    </div>
                </section>
                <%}%>
            </div>
        </main>

        <%- include('../common/footer') -%>
    </body>

    <script>
        var isMenuOpened = false;

        function funcDoMenu() {
            if (isMenuOpened == false) {
                isMenuOpened = !isMenuOpened;
                document.getElementsByClassName('header__slide')[0].style.width = '300px';
            } else {
                isMenuOpened = !isMenuOpened;
                document.getElementsByClassName('header__slide')[0].style.width = '0px';
            }
        }
    </script>
</html>
